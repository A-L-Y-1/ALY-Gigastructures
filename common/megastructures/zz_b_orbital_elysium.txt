orbital_elysium_0 = {
	entity = "giga_orbital_habitat_entity_01_entity"
	construction_entity = "giga_orbital_habitat_entity_01_entity"
	construction_blocks_and_blocked_by = none
	portrait = "GFX_megastructure_construction_background"
	place_entity_on_planet_plane = no
	prerequisites = { giga_tech_orbital_elysium }

	build_time = 1800
	resources = {
		category = giga_kilostructures
		cost = {
			alloys = 1500
			influence = 150
		}
	}

	potential = {
		NOT = { has_global_flag = giga_habitats_disabled }
		is_giga_one_planet_origin = no
		has_technology = giga_tech_orbital_elysium
	}

	possible = {
		custom_tooltip = { fail_text = "requires_inside_border"		is_inside_border = from }
	}

	placement_rules = {
		planet_possible = {
			custom_tooltip = { fail_text = "requires_surveyed_planet"			is_surveyed = { who = prev.from status = yes } }
			custom_tooltip = { fail_text = "requires_no_anomaly"				has_anomaly = no }
			custom_tooltip = { fail_text = "requires_not_star"					is_star = no }
			custom_tooltip = { fail_text = "requires_no_existing_megastructure"	planet_has_no_megastructure = yes }
			custom_tooltip = { fail_text = "requires_no_existing_megastructure"	NOT = { has_planet_flag = has_orbital_elysium } }
		}
	}

	ai_weight = {
		weight = value:giga_ai_base_kilo


	}

	on_build_complete = {
		save_event_target_as = giga_system
		fromfrom.planet = {
			save_event_target_as = giga_planet
			giga_set_has_mega_flag = yes
			set_planet_flag = has_orbital_elysium

			add_modifier = {
				modifier = giga_elysium_host_planet
			}

			remove_all_buildings = yes
			
			if = {
				limit = {
					owner = { is_gestalt = no }
				}
				add_building = building_giga_elysium_host_capital
				add_building = building_giga_elysium_host_jobs
			}
			else_if = {
				limit = {
					owner = { is_hive_empire = yes }
				}
				add_building = building_giga_elysium_host_hive_capital
				add_building = building_giga_elysium_host_hive_jobs
			}
			else_if = {
				limit = {
					owner = { is_machine_empire = yes }
				}
				add_building = building_giga_elysium_host_machine_capital
				add_building = building_giga_elysium_host_machine_jobs
			}

			validate_planet_buildings_and_districts = yes
		}
		from = {
			if = {
				limit = {
					fromfrom = {
						not = { 
							has_megastructure_flag = "origin_elysium" # flag applied by auto-built elysiums from the origin to hide the notification
						}
					}
				}
				set_timed_country_flag = { flag = has_recently_built_giga_orbital_elysiums years = 20 }
				country_event = { id = giga_dialog.1101 }	# Notification
			}
			change_variable = { which = giga_orbital_elysiums value = 1 }
			change_variable = { which = giga_current_elysium value = 1 }
			if = {
				limit = {
					NOR = {
						has_global_flag = giga_achievements_disabled
						has_country_flag = giga_achievement_63
					}
				}
				set_country_flag = giga_achievement_63
				set_timed_country_flag = { flag = giga_achievement_63_notification days = 30 }
				giga_achievement_sound = yes
			}
		}
		spawn_planet = {
			class = "pc_giga_elysium"
			location = fromfrom.planet
			orbit_location = yes
			size = 5
			has_ring = no

			init_effect = {
				set_surveyed = { surveyed = yes surveyor = from }
				set_all_comms_surveyed = yes
				clear_blockers = yes
				set_planet_flag = forbid_guillis_planet_modifiers
				set_planet_flag = megastructure
				set_planet_flag = colony_event			# Vanilla uses to prevent unwanted events on planets
				set_planet_flag = giga_elysium

				start_colony = {
					owner = from
					# TODO: determine appropriate species for this to make sure a proper one gets picked
				}

				set_name = {
					key = "GIGA_ELYSIUM_PLANET_NAME"
					variable_string = "[FROM.from.planet.GetName]"
				}
			}
		}
		remove_megastructure = fromfrom
	}
}